{% extends "photos/header.html" %}



{% block content %}
{% load staticfiles %}

<div id="googlemaps"></div>

<div id="index">
	<div class="photo_container">
		<div id="index_nav">
			<div id="index_nav_year">2016</div>
		</div>
		{% for photo in photos %}
			<div class='photo' id='photo-{{ forloop.counter }}'>
				<div class='photo_title'>
					<div id='{{photo.title}}_{{photo.id}}'>{{photo.title}}</div>
				</div>
				<div class='photo_date'>
					{{photo.date|date:"Y-m-d"}}
				</div>
				<div class='photo_holder'>
					<img class='photo_photo' src="{{photo.url}}">
				</div>
				<div class='purchase_link'>
					<a href='{{photo.purchase_link}}'>Buy this photo</a>
				</div>
			</div>
		{% endfor %}
	</div>
</div>


<footer>
<script src="http://maps.googleapis.com/maps/api/js"></script>

	<script type="text/javascript">

	var position = [ '{{ photos.0.latitude }}', '{{ photos.0.longitude }}'];


	function showGoogleMaps() {

	    var latLng = new google.maps.LatLng(position[0], position[1]);

	    var mapOptions = {
	        zoom: 2, // initialize zoom level - the max value is 21
	        streetViewControl: false, // hide the yellow Street View pegman
	        scaleControl: true, // allow users to zoom the Google Map
	        mapTypeId: google.maps.MapTypeId.ROADMAP,
	        styles: [{"featureType":"all","elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#000000"},{"lightness":40}]},{"featureType":"all","elementType":"labels.text.stroke","stylers":[{"visibility":"on"},{"color":"#000000"},{"lightness":16}]},{"featureType":"all","elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":17},{"weight":1.2}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":21}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":29},{"weight":0.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":16}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":19}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":17}]}],
	        center: latLng,
	        mapTypeControl: false
	    };

	    map = new google.maps.Map(document.getElementById('googlemaps'),
	        mapOptions);

	    //Make a marker with a click
	    //map.addListener('click', function(e) {
	    //	placeMarkerAndPanTo(e.latLng, map);
	  	//});

	    var icon_active = {
		    url: "{% static "photos/img/map_marker_active.png" %}", // url
		    scaledSize: new google.maps.Size(30, 30), // scaled size
		    origin: new google.maps.Point(0,0), // origin
		    anchor: new google.maps.Point(0,0), // anchor
		    description: '{{photos.0.title}}',
    		//url: "{{photos.0.url}}"
		};

		// Show the default marker at the location
		marker = new google.maps.Marker({
		    position: latLng,
		    map: map,
		    draggable: false,
		    animation: google.maps.Animation.DROP,
		    icon: icon_active
		});


	    var icon_incative = {
		    url: "{% static "photos/img/map_marker_inactive.png" %}", // url
		    scaledSize: new google.maps.Size(30, 30), // scaled size
		    origin: new google.maps.Point(0,0), // origin
		    anchor: new google.maps.Point(0,0) // anchor
		};


		{% for photo in photos %}
			{% if not forloop.first %}

				createMarker('{{photo.title}}')
				console.log('{{photo.title}}')

				function createMarker(t) {
				    var marker = new google.maps.Marker({
				        position: new google.maps.LatLng({{photo.latitude}}, {{photo.longitude}}),
				        map: map,
				        title: t,
				        draggable: false,
				        icon: icon_incative
				    });
				    google.maps.event.addListener(marker, 'click', function() {
				       // top position relative to the document

				       var child = $('#photo-2');
				       var parent = $('#index');

				       document.getElementById('index').scrollTop += child.offset().top-parent.offset().top - 45;

				       //console.log(child.offset().top-parent.offset().top)
				       //console.log(document.getElementById('index').scrollTop);

				    });
				    return marker;
				}


		    {%	endif %}
		{% endfor %}



	}

	google.maps.event.addDomListener(window, 'load', showGoogleMaps);



	function placeMarkerAndPanTo(latLng, map) {
	  var marker = new google.maps.Marker({
	    position: latLng,
	    map: map
	  });
	  map.panTo(latLng);
	}

	</script>
</footer>


{% endblock %}

