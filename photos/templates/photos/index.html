{% extends "photos/header.html" %}



{% block content %}
{% load staticfiles %}

<div id="googlemaps"></div>

<div id="index">
	<div class="photo_container">
		<div id="index_nav">
			<div id="index_nav_year">2016</div>
		</div>
		{% for photo in photos %}
			<div class='photo' id='photo-{{ forloop.counter }}'>
				<div class='photo_title'>
					<div id='{{photo.title}}_{{photo.id}}'>{{photo.title}}</div>
				</div>
				<div class='photo_date'>
					{{photo.date|date:"Y-m-d"}}
				</div>
				<div class='photo_holder'>
					<img class='photo_photo' src="{{photo.url}}">
				</div>
				<div class='purchase_link'>
					<a href='{{photo.purchase_link}}'>Buy this photo</a>
				</div>
			</div>
		{% endfor %}
	</div>
</div>


<footer>
<script src="http://maps.googleapis.com/maps/api/js"></script>

	<script type="text/javascript">

	var position = [ '{{ photos.0.latitude }}', '{{ photos.0.longitude }}'];


	function showGoogleMaps() {

	    var mapOptions = {
	        zoom: 10, // initialize zoom level - the max value is 21
	        streetViewControl: false, // hide the yellow Street View pegman
	        scaleControl: true, // allow users to zoom the Google Map
	        mapTypeId: google.maps.MapTypeId.ROADMAP,
	        styles: [{"featureType":"all","elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#000000"},{"lightness":40}]},{"featureType":"all","elementType":"labels.text.stroke","stylers":[{"visibility":"on"},{"color":"#000000"},{"lightness":16}]},{"featureType":"all","elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":17},{"weight":1.2}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":20}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":21}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#000000"},{"lightness":29},{"weight":0.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":16}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":19}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#000000"},{"lightness":17}]}],
	        center: new google.maps.LatLng(position[0], position[1]),
	        mapTypeControl: false
	    };

	    map = new google.maps.Map(document.getElementById('googlemaps'),
	        mapOptions);

	    //Make a marker with a click
	    //map.addListener('click', function(e) {
	    //	placeMarkerAndPanTo(e.latLng, map);
	  	//});

	    var icon_active = {
		    url: "{% static "photos/img/map_marker_active.png" %}", // url
		    scaledSize: new google.maps.Size(30, 30), // scaled size
		    origin: new google.maps.Point(0,0), // origin
		    anchor: new google.maps.Point(0,0), // anchor
		    //description: '{{photos.0.title}}',
    		//url: "{{photos.0.url}}"
		};

	    var icon_inactive = {
		    url: "{% static "photos/img/map_marker_inactive.png" %}", // url
		    scaledSize: new google.maps.Size(30, 30), // scaled size
		    origin: new google.maps.Point(0,0), // origin
		    anchor: new google.maps.Point(0,0) // anchor
		};

		var markers = [];

		{% for photo in photos %}

			var loan = "{{photo.title}}"
			var lat = {{photo.latitude}}
			var long = {{photo.longitude}}
			var add = "{{photo.location_string}}"

    	 	latlngset = new google.maps.LatLng(lat, long);

			var marker = new google.maps.Marker({
			    map: map,
			    title: loan,
			    position: latlngset,
				icon: {% if not forloop.first %}icon_inactive{% else %}icon_active{% endif %},
				description: {{forloop.counter}}
			});

			markers.push(marker);


	    	google.maps.event.addListener(marker,'click', (function(marker){
    	        return function() {

					var child = $('#photo-' + marker.description);
					var parent = $('#index');

					for (i = 0; i < markers.length; i++) {
					    markers[i].setIcon(icon_inactive);

					}

					document.getElementById('index').scrollTop += child.offset().top-parent.offset().top - 45;
					marker.setIcon(icon_active);
					map.setCenter(marker.getPosition());
    	        };
    	    })(marker));

/* if I ever want to add InfoWindow
			var content = add
    	  	var infowindow = new google.maps.InfoWindow()

	    	google.maps.event.addListener(marker,'click', (function(marker,content,infowindow){
    	        return function() {

					var child = $('#photo-' + marker.description);
					var parent = $('#index');
					infowindow.close();

					for (i = 0; i < markers.length; i++) {
					    markers[i].setIcon(icon_inactive);

					}

					infowindow.setContent(content);
					infowindow.open(map,marker);

					document.getElementById('index').scrollTop += child.offset().top-parent.offset().top - 45;
					marker.setIcon(icon_active);
					map.setCenter(marker.getPosition());
    	        };
    	    })(marker,content,infowindow));  */
		{% endfor %}
	}

	google.maps.event.addDomListener(window, 'load', showGoogleMaps);


	</script>
</footer>


{% endblock %}

